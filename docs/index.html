<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scraper for the Prudential Regulation Authority rulebook • PRArulebook</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Scraper for the Prudential Regulation Authority rulebook">
<meta property="og:description" content="Scrape the Prudential Regulation Authority rulebook.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">PRArulebook</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.98</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Introduction-to-PRA-rulebook.html">Introduction to PRArulebook package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/erzk/PRArulebook/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="prarulebook" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#prarulebook" class="anchor"></a>PRArulebook</h1></div>
<!-- badges: start -->

<p><code>PRArulebook</code> is a package to scrape the PRA (Prudential Regulation Authority) <a href="http://www.prarulebook.co.uk/">Rulebook</a> (the website containing the rules made and enforced by the PRA under powers conferred by the Financial Services and Markets Act 2000 (FSMA)).</p>
<p>The input to this package is the PRA Rulebook website. Outputs from this package are the rules published on the PRA Rulebook website in a format more amenable to text and network analysis.</p>
<p><code>PRArulebook</code> was developed while preparing:</p>
<p>**Amadxarif, Z., Brookes, J., Garbarino, N., Patel, R., Walczak, E.</p>
<p>(2019) <em><a href="https://www.bankofengland.co.uk/working-paper/2019/the-language-of-rules-textual-complexity-in-banking-reforms">The Language of Rules: Textual Complexity in Banking Reforms.</a></em> Staff Working Paper No. 834. Bank of England.**</p>
<p>Any use of this package with the PRA Rulebook must comply with the PRA Rulebook’s <a href="http://www.prarulebook.co.uk/terms-of-use">Terms of Use</a>. These include, but are not limited to, restrictions on using content from the PRA Rulebook for commercial purposes without obtaining a licence from the PRA.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version of <code>PRArulebook</code> from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"erzk/PRArulebook"</span><span class="op">)</span></code></pre></div>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<p><code>PRArulebook</code> scrapes two types of data: <strong>structure</strong> and <strong>content</strong>.</p>
<ul>
<li><p><strong>Structure</strong> - hierarchy of the PRA Rulebook. Includes URLs and names.</p></li>
<li>
<p><strong>Content</strong></p>
<ul>
<li>Text - can be used for text analysis</li>
<li>Network - can be used for network analysis.</li>
</ul>
</li>
</ul>
<p>The next section shows how to extract these types of data.</p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>Load the package</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.bankofengland.co.uk/-/media/boe/files/working-paper/2019/the-language-of-rules-textual-complexity-in-banking-reforms.pdf">PRArulebook</a></span><span class="op">)</span></code></pre></div>
<div id="structure" class="section level3">
<h3 class="hasAnchor">
<a href="#structure" class="anchor"></a>Structure</h3>
<p>The simplest way to extract a rulebook structure is to use <code>get_structure</code> function</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get the structure of the rulebook down to the part-level</span>
<span class="va">parts</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="reference/get_structure.html">get_structure</a></span><span class="op">(</span><span class="st">"16-11-2007"</span>,
                layer <span class="op">=</span> <span class="st">"part"</span><span class="op">)</span>
<span class="co"># or chapter-level</span>
<span class="co"># warnings (410) are displayed for inactive sites</span>
<span class="va">chapters</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="reference/get_structure.html">get_structure</a></span><span class="op">(</span><span class="st">"18-06-2019"</span>,
                layer <span class="op">=</span> <span class="st">"chapter"</span><span class="op">)</span></code></pre></div>
<p>This will start scraping the PRA rulebook. Warnings (<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">410</a> code) will be displayed when a page is no longer active. Pulling data will take longer if you decide to pull more granular data. The rulebook has several layers and each of them can be passed to the <code>layer</code> argument of <code>get_structure</code> (in descending order):</p>
<ul>
<li><code>sector</code></li>
<li><code>part</code></li>
<li><code>chapter</code></li>
</ul>
<p>The output will be a data frame with information about the structure (i.e. URLs and names).</p>
<p>Scraping individual rules is much slower so another function should be used</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract all rules from the first three chapters</span>
<span class="va">rules</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/scrape_rule_structure.html">scrape_rule_structure</a></span><span class="op">(</span><span class="va">chapters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span>, <span class="st">"18-06-2019"</span><span class="op">)</span></code></pre></div>
</div>
<div id="content" class="section level3">
<h3 class="hasAnchor">
<a href="#content" class="anchor"></a>Content</h3>
<p>Once the structure URLs are scraped, they can be used to extract content.</p>
<div id="text" class="section level4">
<h4 class="hasAnchor">
<a href="#text" class="anchor"></a>Text</h4>
<p>To get content of the rulebook (text or links) use <code>get_content</code> function with a URL of a given chapter.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># scrape text from a single chapter</span>
<span class="va">chapter_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_content.html">get_content</a></span><span class="op">(</span><span class="va">chapters</span><span class="op">$</span><span class="va">chapter_url</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="co"># or single rule</span>
<span class="va">rule_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_content.html">get_content</a></span><span class="op">(</span><span class="va">rules</span><span class="op">$</span><span class="va">rule_url</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="st">"text"</span>, <span class="st">"yes"</span><span class="op">)</span></code></pre></div>
<p>This function can be applied on the entire rulebook in the following way:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>

<span class="co"># text: chapter-level</span>
<span class="co"># exception handling might be needed</span>
<span class="va">chapters_text</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span><span class="op">(</span><span class="va">chapters</span><span class="op">$</span><span class="va">chapter_url</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,
                <span class="va">get_content</span><span class="op">)</span>

<span class="co"># text</span>
<span class="va">rules_text</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span><span class="op">(</span><span class="va">rules</span><span class="op">$</span><span class="va">rule_url</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,
         <span class="va">get_content</span>,
         type <span class="op">=</span> <span class="st">"text"</span>,
         single_rule_selector <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span>

<span class="co"># links</span>
<span class="va">rules_links</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span><span class="op">(</span><span class="va">rules</span><span class="op">$</span><span class="va">rule_url</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,
         <span class="va">get_content</span>,
         type <span class="op">=</span> <span class="st">"links"</span>,
         single_rule_selector <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span></code></pre></div>
<p>The output can be then joined to the information about the rulebook structure and aggregated at a higher level.</p>
</div>
<div id="network" class="section level4">
<h4 class="hasAnchor">
<a href="#network" class="anchor"></a>Network</h4>
<p>To scrape the links and create data set for network analysis <code>get_content</code> function can be used but with a <code>type</code> argument set to <code>"links"</code>. Like in the previous example, this call can also be parallelised.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chapter_link</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_content.html">get_content</a></span><span class="op">(</span><span class="va">chapters</span><span class="op">$</span><span class="va">chapter_url</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"links"</span><span class="op">)</span>

<span class="co"># sequential</span>
<span class="va">parts_links</span> <span class="op">&lt;-</span>
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span><span class="op">(</span><span class="va">parts</span><span class="op">$</span><span class="va">part_url</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,
                <span class="va">get_content</span>,
                <span class="st">"links"</span><span class="op">)</span></code></pre></div>
<p>The code above will return a data frame with <em>from/to url</em>, <em>text</em> used in a link, and a <em>type</em> of a link.</p>
<p>Scraped data containing information about the links can be used for network analysis (warning: further cleaning might be required).</p>
</div>
</div>
<div id="disclaimer" class="section level3">
<h3 class="hasAnchor">
<a href="#disclaimer" class="anchor"></a>Disclaimer</h3>
<p>This package is an outcome of a research project. All errors are mine. All views expressed are personal views, not those of any employer.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/erzk/PRArulebook/">https://​github.com/​erzk/​PRArulebook/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/erzk/PRArulebook/issues">https://​github.com/​erzk/​PRArulebook/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing PRArulebook</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Eryk Walczak <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8724-462X" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active Ã¢â‚¬â€œ The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://travis-ci.org/erzk/PRArulebook"><img src="https://travis-ci.org/erzk/PRArulebook.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
<li><a href="https://cran.r-project.org/package=PRArulebook"><img src="https://www.r-pkg.org/badges/version/PRArulebook" alt="CRAN status"></a></li>
<li><a href="https://codecov.io/gh/erzk/PRArulebook?branch=master"><img src="https://codecov.io/gh/erzk/PRArulebook/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/192198090"><img src="https://zenodo.org/badge/192198090.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Eryk Walczak.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
